<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALEEM CAR SALES | Admin Login</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        }
        
        body { 
            background: linear-gradient(135deg, #1d2327 0%, #000000 100%);
            color: #333; 
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .login-container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .logo {
            font-size: 2rem;
            font-weight: 700;
            color: #000;
            margin-bottom: 10px;
        }
        
        .logo span {
            color: #e74c3c;
        }
        
        .slogan {
            color: #666;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #e74c3c;
        }
        
        textarea {
            height: 80px;
            resize: vertical;
        }
        
        .button {
            background: #e74c3c;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s;
        }
        
        .button:hover {
            background: #c0392b;
        }
        
        .error-message {
            color: #e74c3c;
            margin-top: 10px;
            display: none;
        }
        
        .admin-dashboard {
            display: none;
            width: 100%;
            height: 100vh;
            background: #f1f1f1;
        }

        /* Admin Dashboard Styles */
        #wpadminbar { 
            background: #1d2327; 
            color: #f0f0f1; 
            height: 60px; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            z-index: 9999; 
            display: flex; 
            align-items: center; 
            padding: 0 20px; 
        }
        
        .wp-admin-bar-logo { 
            font-size: 1.5rem; 
            font-weight: 700; 
            color: white; 
            text-decoration: none; 
            margin-right: 20px; 
        }
        
        .wp-admin-bar-logo span { 
            color: #e74c3c; 
        }
        
        .quick-links { 
            display: flex; 
            margin-left: auto; 
        }
        
        .quick-links a { 
            color: #f0f0f1; 
            text-decoration: none; 
            padding: 0 10px; 
            font-size: 0.9rem; 
        }
        
        .quick-links a:hover { 
            color: #f1c40f; 
        }
        
        .user-info { 
            margin-left: 20px; 
            display: flex; 
            align-items: center; 
        }

        #admin-dashboard { 
            display: flex; 
            margin-top: 60px; 
            min-height: calc(100vh - 60px); 
        }
        
        #admin-sidebar { 
            width: 200px; 
            background: #1d2327; 
            color: #f0f0f1; 
            position: fixed; 
            height: calc(100vh - 60px); 
            overflow-y: auto; 
        }
        
        .sidebar-header { 
            padding: 20px 15px; 
            border-bottom: 1px solid #2c3338; 
        }
        
        .sidebar-header h3 { 
            color: #f1c40f; 
        }
        
        .admin-menu { 
            list-style: none; 
            padding: 10px 0; 
        }
        
        .admin-menu li { 
            margin-bottom: 5px; 
        }
        
        .admin-menu a { 
            display: flex; 
            align-items: center; 
            padding: 12px 15px; 
            color: #f0f0f1; 
            text-decoration: none; 
            transition: all 0.2s; 
        }
        
        .admin-menu a:hover, 
        .admin-menu a.active { 
            background: #2c3338; 
            color: #f1c40f; 
        }
        
        .admin-menu a i { 
            margin-right: 10px; 
        }

        #admin-content { 
            flex: 1; 
            margin-left: 200px; 
            padding: 20px; 
        }
        
        .welcome-panel { 
            background: white; 
            border: 1px solid #c3c4c7; 
            border-radius: 4px; 
            margin-bottom: 20px; 
            padding: 20px; 
        }
        
        .dashboard-widgets { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 20px; 
            margin-bottom: 20px; 
        }
        
        .dashboard-widget { 
            background: white; 
            border: 1px solid #c3c4c7; 
            border-radius: 4px; 
            overflow: hidden; 
        }
        
        .widget-header { 
            background: #f6f7f7; 
            border-bottom: 1px solid #c3c4c7; 
            padding: 15px; 
            font-weight: 600; 
        }
        
        .widget-content { 
            padding: 15px; 
        }
        
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 15px; 
        }
        
        .stat-item { 
            text-align: center; 
            padding: 15px; 
            border-radius: 4px; 
        }
        
        .stat-item.primary { 
            background: #e7f3ff; 
            border-left: 4px solid #2271b1; 
        }
        
        .stat-item.success { 
            background: #edf7ed; 
            border-left: 4px solid #46b450; 
        }
        
        .stat-item.warning { 
            background: #fff8e5; 
            border-left: 4px solid #ffb900; 
        }
        
        .stat-item.danger { 
            background: #fcf0f1; 
            border-left: 4px solid #d63638; 
        }
        
        .stat-number { 
            font-size: 1.8rem; 
            font-weight: 700; 
        }
        
        .admin-page { 
            display: none; 
            background: white; 
            border: 1px solid #c3c4c7; 
            border-radius: 4px; 
            padding: 20px; 
        }
        
        .admin-page.active { 
            display: block; 
        }
        
        .page-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 20px; 
            padding-bottom: 15px; 
            border-bottom: 1px solid #f0f0f1; 
        }
        
        .form-table { 
            width: 100%; 
            border-collapse: collapse; 
        }
        
        .form-table th { 
            text-align: left; 
            padding: 15px 10px 15px 0; 
            width: 200px; 
            font-weight: 600; 
        }
        
        .form-table td { 
            padding: 15px 0; 
        }
        
        .button-admin { 
            background: #2271b1; 
            color: white; 
            padding: 8px 15px; 
            border: none; 
            border-radius: 3px; 
            cursor: pointer; 
            text-decoration: none; 
            margin: 2px;
        }
        
        .button-admin:hover { 
            background: #135e96; 
        }
        
        .button-primary { 
            background: #2271b1; 
        }
        
        .button-danger { 
            background: #d63638; 
        }
        
        .button-success {
            background: #46b450;
        }
        
        .image-preview {
            max-width: 200px;
            max-height: 150px;
            margin-top: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: none;
        }
        
        .file-upload {
            border: 2px dashed #ddd;
            padding: 20px;
            text-align: center;
            border-radius: 5px;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        
        .file-upload:hover {
            border-color: #e74c3c;
        }
        
        @media (max-width: 768px) {
            #admin-sidebar { 
                width: 60px; 
            }
            
            #admin-content { 
                margin-left: 60px; 
            }
            
            .admin-menu a span { 
                display: none; 
            }
            
            .admin-menu a i { 
                margin-right: 0; 
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="login-container">
        <div class="logo">ALEEM <span>CAR SALES</span></div>
        <div class="slogan">Admin Dashboard</div>
        
        <form id="login-form">
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" required placeholder="Enter admin username">
            </div>
            
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" required placeholder="Enter admin password">
            </div>
            
            <button type="submit" class="button">Login</button>
            <div class="error-message" id="error-message">Invalid username or password</div>
        </form>
    </div>

    <!-- Admin Dashboard (Hidden until login) -->
    <div id="admin-dashboard" class="admin-dashboard"></div>

    <script>
        // Admin credentials - CHANGE THESE TO YOUR PREFERRED CREDENTIALS!
        const ADMIN_CREDENTIALS = {
            username: "aleemadmin",
            password: "carsales123"  // ‚ö†Ô∏è CHANGE THIS PASSWORD!
        };

        // DOM Elements
        const loginContainer = document.getElementById('login-container');
        const adminDashboard = document.getElementById('admin-dashboard');
        const loginForm = document.getElementById('login-form');
        const errorMessage = document.getElementById('error-message');

        // Login form handler
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                // Successful login
                loginContainer.style.display = 'none';
                adminDashboard.style.display = 'block';
                loadAdminDashboard();
            } else {
                // Failed login
                errorMessage.style.display = 'block';
                document.getElementById('password').value = '';
            }
        });

        function loadAdminDashboard() {
            // Load the full admin dashboard content
            adminDashboard.innerHTML = `
                <!-- WordPress Admin Bar -->
                <div id="wpadminbar">
                    <div style="display: flex; align-items: center; width: 100%;">
                        <a href="index.html" class="wp-admin-bar-logo">ALEEM <span>CAR SALES</span></a>
                        <div class="quick-links">
                            <a href="index.html">View Site</a>
                            <a href="#" id="logout-admin">Log Out</a>
                        </div>
                        <div class="user-info">
                            <span>Admin User</span>
                        </div>
                    </div>
                </div>

                <!-- Admin Dashboard -->
                <div id="admin-dashboard-inner">
                    <!-- Admin Sidebar -->
                    <div id="admin-sidebar">
                        <div class="sidebar-header">
                            <h3>Dashboard Menu</h3>
                        </div>
                        <ul class="admin-menu">
                            <li><a href="#" class="menu-item active" data-page="dashboard"><i class="fas fa-tachometer-alt"></i> <span>Dashboard</span></a></li>
                            <li><a href="#" class="menu-item" data-page="cars"><i class="fas fa-car"></i> <span>Cars</span></a></li>
                            <li><a href="#" class="menu-item" data-page="services"><i class="fas fa-concierge-bell"></i> <span>Services</span></a></li>
                            <li><a href="#" class="menu-item" data-page="financing"><i class="fas fa-money-bill-wave"></i> <span>Financing</span></a></li>
                        </ul>
                    </div>

                    <!-- Admin Content -->
                    <div id="admin-content">
                        <!-- Dashboard Page -->
                        <div class="admin-page active" id="dashboard-page">
                            <div class="welcome-panel">
                                <h2>Welcome to ALEEM CAR SALES Dashboard</h2>
                                <p>Manage your car inventory, services, and financing options from this dashboard.</p>
                                
                                <div class="stats-grid" style="margin-top: 20px;">
                                    <div class="stat-item primary">
                                        <div class="stat-number" id="total-cars">0</div>
                                        <div class="stat-label">Total Cars</div>
                                    </div>
                                    <div class="stat-item success">
                                        <div class="stat-number" id="available-cars">0</div>
                                        <div class="stat-label">Available</div>
                                    </div>
                                    <div class="stat-item warning">
                                        <div class="stat-number" id="sold-cars">0</div>
                                        <div class="stat-label">Sold</div>
                                    </div>
                                </div>
                            </div>

                            <div class="dashboard-widgets">
                                <div class="dashboard-widget">
                                    <div class="widget-header">Quick Actions</div>
                                    <div class="widget-content">
                                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                            <a href="#" class="button-admin button-primary menu-item" data-page="cars" style="text-align: center; padding: 15px;">
                                                <i class="fas fa-plus-circle"></i><br>Add New Car
                                            </a>
                                            <a href="#" class="button-admin button-primary menu-item" data-page="services" style="text-align: center; padding: 15px;">
                                                <i class="fas fa-edit"></i><br>Edit Services
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="dashboard-widget">
                                    <div class="widget-header">Recent Cars</div>
                                    <div class="widget-content">
                                        <div id="recent-cars-list">
                                            <!-- Recent cars will appear here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Cars Management Page -->
                        <div class="admin-page" id="cars-page">
                            <div class="page-header">
                                <h1>Manage Cars</h1>
                                <button class="button-admin button-primary" id="add-car-btn">Add New Car</button>
                            </div>
                            
                            <!-- Car Form -->
                            <div id="car-form-container" style="display: none; background: white; padding: 20px; border-radius: 4px; margin-bottom: 20px;">
                                <form id="car-form">
                                    <table class="form-table">
                                        <tr>
                                            <th><label for="car-make">Make</label></th>
                                            <td><input type="text" id="car-make" required></td>
                                        </tr>
                                        <tr>
                                            <th><label for="car-model">Model</label></th>
                                            <td><input type="text" id="car-model" required></td>
                                        </tr>
                                        <tr>
                                            <th><label for="car-year">Year</label></th>
                                            <td><input type="number" id="car-year" min="2000" max="2023" required></td>
                                        </tr>
                                        <tr>
                                            <th><label for="car-price">Price (R)</label></th>
                                            <td><input type="number" id="car-price" required></td>
                                        </tr>
                                        <tr>
                                            <th><label for="car-mileage">Mileage</label></th>
                                            <td><input type="text" id="car-mileage" required></td>
                                        </tr>
                                        <tr>
                                            <th><label for="car-transmission">Transmission</label></th>
                                            <td>
                                                <select id="car-transmission" required>
                                                    <option value="Automatic">Automatic</option>
                                                    <option value="Manual">Manual</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th><label for="car-description">Description</label></th>
                                            <td><textarea id="car-description"></textarea></td>
                                        </tr>
                                        <tr>
                                            <th><label for="car-status">Status</label></th>
                                            <td>
                                                <select id="car-status" required>
                                                    <option value="available">Available</option>
                                                    <option value="sold">Sold</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th><label for="car-image">Car Image</label></th>
                                            <td>
                                                <div class="file-upload" id="image-upload-area">
                                                    <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: #666; margin-bottom: 10px;"></i>
                                                    <div>Click to upload car image</div>
                                                    <div style="font-size: 0.8rem; color: #999; margin-top: 5px;">JPG, PNG, GIF up to 5MB</div>
                                                    <input type="file" id="car-image-file" accept="image/*" style="display: none;">
                                                </div>
                                                <img id="image-preview" class="image-preview" alt="Image preview">
                                            </td>
                                        </tr>
                                    </table>
                                    <div style="margin-top: 20px;">
                                        <button type="submit" class="button-admin button-primary" id="car-submit-btn">Add Vehicle</button>
                                        <button type="button" class="button-admin" id="cancel-car-form">Cancel</button>
                                    </div>
                                    <input type="hidden" id="editing-car-id" value="">
                                </form>
                            </div>
                            
                            <!-- Cars List -->
                            <div id="cars-list-container">
                                <div class="dashboard-widget">
                                    <div class="widget-header">All Cars</div>
                                    <div class="widget-content">
                                        <div id="admin-cars-list">
                                            <!-- Cars will appear here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Services Management Page -->
                        <div class="admin-page" id="services-page">
                            <div class="page-header">
                                <h1>Manage Services</h1>
                                <button class="button-admin button-primary" id="add-service-btn">Add New Service</button>
                            </div>
                            
                            <!-- Service Form -->
                            <div id="service-form-container" style="display: none; background: white; padding: 20px; border-radius: 4px; margin-bottom: 20px;">
                                <form id="service-form">
                                    <table class="form-table">
                                        <tr>
                                            <th><label for="service-title">Service Title</label></th>
                                            <td><input type="text" id="service-title" required></td>
                                        </tr>
                                        <tr>
                                            <th><label for="service-description">Description</label></th>
                                            <td><textarea id="service-description" required></textarea></td>
                                        </tr>
                                        <tr>
                                            <th><label for="service-icon">Icon</label></th>
                                            <td>
                                                <select id="service-icon" required>
                                                    <option value="üöó">Car - üöó</option>
                                                    <option value="üí∞">Money - üí∞</option>
                                                    <option value="üîß">Tools - üîß</option>
                                                    <option value="üéØ">Target - üéØ</option>
                                                    <option value="‚ö°">Lightning - ‚ö°</option>
                                                    <option value="üõ°Ô∏è">Shield - üõ°Ô∏è</option>
                                                </select>
                                            </td>
                                        </tr>
                                    </table>
                                    <div style="margin-top: 20px;">
                                        <button type="submit" class="button-admin button-primary" id="service-submit-btn">Add Service</button>
                                        <button type="button" class="button-admin" id="cancel-service-form">Cancel</button>
                                    </div>
                                    <input type="hidden" id="editing-service-id" value="">
                                </form>
                            </div>
                            
                            <!-- Services List -->
                            <div id="services-list-container">
                                <div class="dashboard-widget">
                                    <div class="widget-header">Current Services</div>
                                    <div class="widget-content">
                                        <div id="admin-services-list">
                                            <!-- Services will appear here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Financing Management Page -->
                        <div class="admin-page" id="financing-page">
                            <div class="page-header">
                                <h1>Manage Financing Options</h1>
                                <button class="button-admin button-primary" id="add-financing-btn">Add New Option</button>
                            </div>
                            
                            <!-- Financing Form -->
                            <div id="financing-form-container" style="display: none; background: white; padding: 20px; border-radius: 4px; margin-bottom: 20px;">
                                <form id="financing-form">
                                    <table class="form-table">
                                        <tr>
                                            <th><label for="financing-title">Option Title</label></th>
                                            <td><input type="text" id="financing-title" required></td>
                                        </tr>
                                        <tr>
                                            <th><label for="financing-description">Description</label></th>
                                            <td><textarea id="financing-description" required></textarea></td>
                                        </tr>
                                    </table>
                                    <div style="margin-top: 20px;">
                                        <button type="submit" class="button-admin button-primary" id="financing-submit-btn">Add Option</button>
                                        <button type="button" class="button-admin" id="cancel-financing-form">Cancel</button>
                                    </div>
                                    <input type="hidden" id="editing-financing-id" value="">
                                </form>
                            </div>
                            
                            <!-- Financing List -->
                            <div id="financing-list-container">
                                <div class="dashboard-widget">
                                    <div class="widget-header">Current Financing Options</div>
                                    <div class="widget-content">
                                        <div id="admin-financing-list">
                                            <!-- Financing options will appear here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Initialize the admin dashboard functionality
            initializeAdminDashboard();
        }

        function initializeAdminDashboard() {
            // Load data from localStorage
            let cars = JSON.parse(localStorage.getItem('aleemCars')) || [];
            let services = JSON.parse(localStorage.getItem('aleemServices')) || [
                { id: 1, title: "Car Sales", description: "Wide selection of quality pre-owned vehicles", icon: "üöó" },
                { id: 2, title: "Financing", description: "Flexible payment plans and loan assistance", icon: "üí∞" },
                { id: 3, title: "Vehicle Service", description: "Professional maintenance and repairs", icon: "üîß" },
                { id: 4, title: "Test Drives", description: "Schedule a test drive at your convenience", icon: "üéØ" }
            ];
            let financingOptions = JSON.parse(localStorage.getItem('aleemFinancing')) || [
                { id: 1, title: "Bank Financing", description: "Partnered with major banks for competitive rates" },
                { id: 2, title: "In-House Financing", description: "Flexible payment plans tailored to your budget" },
                { id: 3, title: "Trade-In Options", description: "Get the best value for your current vehicle" },
                { id: 4, title: "Insurance", description: "Comprehensive insurance packages available" }
            ];

            // Save data to localStorage
            function saveData() {
                localStorage.setItem('aleemCars', JSON.stringify(cars));
                localStorage.setItem('aleemServices', JSON.stringify(services));
                localStorage.setItem('aleemFinancing', JSON.stringify(financingOptions));
            }

            // DOM Elements
            const menuItems = document.querySelectorAll('.menu-item');
            const adminPages = document.querySelectorAll('.admin-page');

            // Navigation
            menuItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetPage = this.getAttribute('data-page');
                    
                    // Update active menu item
                    menuItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show target page
                    adminPages.forEach(page => {
                        page.classList.remove('active');
                        if (page.id === `${targetPage}-page`) {
                            page.classList.add('active');
                        }
                    });
                    
                    // Update dashboard when shown
                    if (targetPage === 'dashboard') {
                        updateDashboardStats();
                    }
                    
                    // Show/hide form containers
                    if (targetPage !== 'cars') {
                        document.getElementById('car-form-container').style.display = 'none';
                        document.getElementById('cars-list-container').style.display = 'block';
                    }
                    if (targetPage !== 'services') {
                        document.getElementById('service-form-container').style.display = 'none';
                        document.getElementById('services-list-container').style.display = 'block';
                    }
                    if (targetPage !== 'financing') {
                        document.getElementById('financing-form-container').style.display = 'none';
                        document.getElementById('financing-list-container').style.display = 'block';
                    }
                });
            });

            // Update dashboard stats
            function updateDashboardStats() {
                const totalCars = cars.length;
                const availableCars = cars.filter(car => car.status === 'available').length;
                const soldCars = cars.filter(car => car.status === 'sold').length;
                
                document.getElementById('total-cars').textContent = totalCars;
                document.getElementById('available-cars').textContent = availableCars;
                document.getElementById('sold-cars').textContent = soldCars;
                
                // Update recent cars list
                const recentCarsList = document.getElementById('recent-cars-list');
                recentCarsList.innerHTML = '';
                
                const recentCars = cars.slice(-3).reverse();
                if (recentCars.length === 0) {
                    recentCarsList.innerHTML = '<p>No cars added yet.</p>';
                } else {
                    recentCars.forEach(car => {
                        const div = document.createElement('div');
                        div.style.padding = '10px 0';
                        div.style.borderBottom = '1px solid #f0f0f1';
                        div.innerHTML = `<strong>${car.make} ${car.model}</strong> - R${car.price.toLocaleString()}`;
                        recentCarsList.appendChild(div);
                    });
                }
            }

            // ========== CAR MANAGEMENT ==========
            const addCarBtn = document.getElementById('add-car-btn');
            const carFormContainer = document.getElementById('car-form-container');
            const carsListContainer = document.getElementById('cars-list-container');
            const carForm = document.getElementById('car-form');
            const cancelCarForm = document.getElementById('cancel-car-form');
            const imageUploadArea = document.getElementById('image-upload-area');
            const carImageFile = document.getElementById('car-image-file');
            const imagePreview = document.getElementById('image-preview');

            let currentCarImageData = null;

            // Image upload functionality
            imageUploadArea.addEventListener('click', function() {
                carImageFile.click();
            });

            carImageFile.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        currentCarImageData = e.target.result;
                        imagePreview.src = currentCarImageData;
                        imagePreview.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Show car form
            addCarBtn.addEventListener('click', function() {
                carFormContainer.style.display = 'block';
                carsListContainer.style.display = 'none';
                resetCarForm();
            });

            // Cancel car form
            cancelCarForm.addEventListener('click', function() {
                carFormContainer.style.display = 'none';
                carsListContainer.style.display = 'block';
                resetCarForm();
            });

            // Reset car form
            function resetCarForm() {
                carForm.reset();
                document.getElementById('editing-car-id').value = '';
                document.getElementById('car-submit-btn').textContent = 'Add Vehicle';
                imagePreview.style.display = 'none';
                currentCarImageData = null;
                carImageFile.value = '';
            }

            // Render admin cars list
            function renderAdminCarsList() {
                const adminCarsList = document.getElementById('admin-cars-list');
                adminCarsList.innerHTML = '';
                
                if (cars.length === 0) {
                    adminCarsList.innerHTML = '<p>No cars added yet. Click "Add New Car" to get started.</p>';
                    return;
                }
                
                cars.forEach(car => {
                    const carDiv = document.createElement('div');
                    carDiv.style.padding = '15px';
                    carDiv.style.border = '1px solid #f0f0f1';
                    carDiv.style.borderRadius = '4px';
                    carDiv.style.marginBottom = '10px';
                    carDiv.style.background = car.status === 'sold' ? '#f9f9f9' : 'white';
                    
                    carDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="flex: 1; display: flex; align-items: center;">
                                <div style="width: 80px; height: 60px; background: #f0f0f0; margin-right: 15px; display: flex; align-items: center; justify-content: center; border-radius: 4px; overflow: hidden;">
                                    ${car.image ? `<img src="${car.image}" alt="${car.make} ${car.model}" style="width:100%;height:100%;object-fit:cover;">` : 'üöó'}
                                </div>
                                <div>
                                    <h3 style="margin: 0 0 5px 0;">${car.make} ${car.model} (${car.year})</h3>
                                    <p style="margin: 0 0 5px 0; color: #666;">${car.mileage} ‚Ä¢ ${car.transmission} ‚Ä¢ R${car.price.toLocaleString()}</p>
                                    <p style="margin: 0; font-size: 0.9em;">${car.description || 'No description'}</p>
                                </div>
                            </div>
                            <div>
                                <span style="background: ${car.status === 'available' ? '#46b450' : '#d63638'}; color: white; padding: 5px 10px; border-radius: 3px; font-size: 0.8em;">
                                    ${car.status === 'available' ? 'Available' : 'Sold'}
                                </span>
                                <button class="button-admin edit-car" data-id="${car.id}" style="margin-left: 10px;">Edit</button>
                                <button class="button-admin button-danger delete-car" data-id="${car.id}" style="margin-left: 5px;">Delete</button>
                            </div>
                        </div>
                    `;
                    
                    adminCarsList.appendChild(carDiv);
                });

                // Add event listeners for edit and delete buttons
                document.querySelectorAll('.edit-car').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const carId = parseInt(this.getAttribute('data-id'));
                        editCar(carId);
                    });
                });
                
                document.querySelectorAll('.delete-car').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const carId = parseInt(this.getAttribute('data-id'));
                        deleteCar(carId);
                    });
                });
            }

            // Edit car
            function editCar(carId) {
                const car = cars.find(c => c.id === carId);
                if (car) {
                    document.getElementById('car-make').value = car.make;
                    document.getElementById('car-model').value = car.model;
                    document.getElementById('car-year').value = car.year;
                    document.getElementById('car-price').value = car.price;
                    document.getElementById('car-mileage').value = car.mileage;
                    document.getElementById('car-transmission').value = car.transmission;
                    document.getElementById('car-description').value = car.description || '';
                    document.getElementById('car-status').value = car.status;
                    
                    if (car.image) {
                        currentCarImageData = car.image;
                        imagePreview.src = car.image;
                        imagePreview.style.display = 'block';
                    }
                    
                    document.getElementById('editing-car-id').value = carId;
                    document.getElementById('car-submit-btn').textContent = 'Update Vehicle';
                    
                    carFormContainer.style.display = 'block';
                    carsListContainer.style.display = 'none';
                }
            }

            // Delete car
            function deleteCar(carId) {
                if (confirm('Are you sure you want to delete this car?')) {
                    cars = cars.filter(c => c.id !== carId);
                    saveData();
                    renderAdminCarsList();
                    updateDashboardStats();
                    alert('Car deleted successfully!');
                }
            }

            // Add or update car
            carForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const carData = {
                    id: document.getElementById('editing-car-id').value || Date.now(),
                    make: document.getElementById('car-make').value,
                    model: document.getElementById('car-model').value,
                    year: parseInt(document.getElementById('car-year').value),
                    price: parseInt(document.getElementById('car-price').value),
                    mileage: document.getElementById('car-mileage').value,
                    transmission: document.getElementById('car-transmission').value,
                    description: document.getElementById('car-description').value,
                    status: document.getElementById('car-status').value,
                    image: currentCarImageData || ''
                };
                
                if (document.getElementById('editing-car-id').value) {
                    // Update existing car
                    const index = cars.findIndex(c => c.id === parseInt(document.getElementById('editing-car-id').value));
                    if (index !== -1) {
                        cars[index] = carData;
                    }
                } else {
                    // Add new car
                    cars.push(carData);
                }
                
                saveData();
                renderAdminCarsList();
                updateDashboardStats();
                resetCarForm();
                carFormContainer.style.display = 'none';
                carsListContainer.style.display = 'block';
                alert(`Car ${document.getElementById('editing-car-id').value ? 'updated' : 'added'} successfully!`);
            });

            // ========== SERVICES MANAGEMENT ==========
            const addServiceBtn = document.getElementById('add-service-btn');
            const serviceFormContainer = document.getElementById('service-form-container');
            const servicesListContainer = document.getElementById('services-list-container');
            const serviceForm = document.getElementById('service-form');
            const cancelServiceForm = document.getElementById('cancel-service-form');

            // Show service form
            addServiceBtn.addEventListener('click', function() {
                serviceFormContainer.style.display = 'block';
                servicesListContainer.style.display = 'none';
                resetServiceForm();
            });

            // Cancel service form
            cancelServiceForm.addEventListener('click', function() {
                serviceFormContainer.style.display = 'none';
                servicesListContainer.style.display = 'block';
                resetServiceForm();
            });

            // Reset service form
            function resetServiceForm() {
                serviceForm.reset();
                document.getElementById('editing-service-id').value = '';
                document.getElementById('service-submit-btn').textContent = 'Add Service';
            }

            // Render services list
            function renderServicesList() {
                const servicesList = document.getElementById('admin-services-list');
                servicesList.innerHTML = '';
                
                if (services.length === 0) {
                    servicesList.innerHTML = '<p>No services added yet.</p>';
                    return;
                }
                
                services.forEach(service => {
                    const serviceDiv = document.createElement('div');
                    serviceDiv.style.padding = '15px';
                    serviceDiv.style.border = '1px solid #f0f0f1';
                    serviceDiv.style.borderRadius = '4px';
                    serviceDiv.style.marginBottom = '10px';
                    serviceDiv.style.background = 'white';
                    
                    serviceDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="flex: 1; display: flex; align-items: center;">
                                <div style="font-size: 2rem; margin-right: 15px;">${service.icon}</div>
                                <div>
                                    <h3 style="margin: 0 0 5px 0;">${service.title}</h3>
                                    <p style="margin: 0; color: #666;">${service.description}</p>
                                </div>
                            </div>
                            <div>
                                <button class="button-admin edit-service" data-id="${service.id}">Edit</button>
                                <button class="button-admin button-danger delete-service" data-id="${service.id}">Delete</button>
                            </div>
                        </div>
                    `;
                    
                    servicesList.appendChild(serviceDiv);
                });

                // Add event listeners for edit and delete buttons
                document.querySelectorAll('.edit-service').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const serviceId = parseInt(this.getAttribute('data-id'));
                        editService(serviceId);
                    });
                });
                
                document.querySelectorAll('.delete-service').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const serviceId = parseInt(this.getAttribute('data-id'));
                        deleteService(serviceId);
                    });
                });
            }

            // Edit service
            function editService(serviceId) {
                const service = services.find(s => s.id === serviceId);
                if (service) {
                    document.getElementById('service-title').value = service.title;
                    document.getElementById('service-description').value = service.description;
                    document.getElementById('service-icon').value = service.icon;
                    
                    document.getElementById('editing-service-id').value = serviceId;
                    document.getElementById('service-submit-btn').textContent = 'Update Service';
                    
                    serviceFormContainer.style.display = 'block';
                    servicesListContainer.style.display = 'none';
                }
            }

            // Delete service
            function deleteService(serviceId) {
                if (confirm('Are you sure you want to delete this service?')) {
                    services = services.filter(s => s.id !== serviceId);
                    saveData();
                    renderServicesList();
                    alert('Service deleted successfully!');
                }
            }

            // Add or update service
            serviceForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const serviceData = {
                    id: document.getElementById('editing-service-id').value || Date.now(),
                    title: document.getElementById('service-title').value,
                    description: document.getElementById('service-description').value,
                    icon: document.getElementById('service-icon').value
                };
                
                if (document.getElementById('editing-service-id').value) {
                    // Update existing service
                    const index = services.findIndex(s => s.id === parseInt(document.getElementById('editing-service-id').value));
                    if (index !== -1) {
                        services[index] = serviceData;
                    }
                } else {
                    // Add new service
                    services.push(serviceData);
                }
                
                saveData();
                renderServicesList();
                resetServiceForm();
                serviceFormContainer.style.display = 'none';
                servicesListContainer.style.display = 'block';
                alert(`Service ${document.getElementById('editing-service-id').value ? 'updated' : 'added'} successfully!`);
            });

            // ========== FINANCING MANAGEMENT ==========
            const addFinancingBtn = document.getElementById('add-financing-btn');
            const financingFormContainer = document.getElementById('financing-form-container');
            const financingListContainer = document.getElementById('financing-list-container');
            const financingForm = document.getElementById('financing-form');
            const cancelFinancingForm = document.getElementById('cancel-financing-form');

            // Show financing form
            addFinancingBtn.addEventListener('click', function() {
                financingFormContainer.style.display = 'block';
                financingListContainer.style.display = 'none';
                resetFinancingForm();
            });

            // Cancel financing form
            cancelFinancingForm.addEventListener('click', function() {
                financingFormContainer.style.display = 'none';
                financingListContainer.style.display = 'block';
                resetFinancingForm();
            });

            // Reset financing form
            function resetFinancingForm() {
                financingForm.reset();
                document.getElementById('editing-financing-id').value = '';
                document.getElementById('financing-submit-btn').textContent = 'Add Option';
            }

            // Render financing list
            function renderFinancingList() {
                const financingList = document.getElementById('admin-financing-list');
                financingList.innerHTML = '';
                
                if (financingOptions.length === 0) {
                    financingList.innerHTML = '<p>No financing options added yet.</p>';
                    return;
                }
                
                financingOptions.forEach(option => {
                    const optionDiv = document.createElement('div');
                    optionDiv.style.padding = '15px';
                    optionDiv.style.border = '1px solid #f0f0f1';
                    optionDiv.style.borderRadius = '4px';
                    optionDiv.style.marginBottom = '10px';
                    optionDiv.style.background = 'white';
                    
                    optionDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="flex: 1;">
                                <h3 style="margin: 0 0 5px 0;">${option.title}</h3>
                                <p style="margin: 0; color: #666;">${option.description}</p>
                            </div>
                            <div>
                                <button class="button-admin edit-financing" data-id="${option.id}">Edit</button>
                                <button class="button-admin button-danger delete-financing" data-id="${option.id}">Delete</button>
                            </div>
                        </div>
                    `;
                    
                    financingList.appendChild(optionDiv);
                });

                // Add event listeners for edit and delete buttons
                document.querySelectorAll('.edit-financing').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const financingId = parseInt(this.getAttribute('data-id'));
                        editFinancing(financingId);
                    });
                });
                
                document.querySelectorAll('.delete-financing').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const financingId = parseInt(this.getAttribute('data-id'));
                        deleteFinancing(financingId);
                    });
                });
            }

            // Edit financing
            function editFinancing(financingId) {
                const option = financingOptions.find(f => f.id === financingId);
                if (option) {
                    document.getElementById('financing-title').value = option.title;
                    document.getElementById('financing-description').value = option.description;
                    
                    document.getElementById('editing-financing-id').value = financingId;
                    document.getElementById('financing-submit-btn').textContent = 'Update Option';
                    
                    financingFormContainer.style.display = 'block';
                    financingListContainer.style.display = 'none';
                }
            }

            // Delete financing
            function deleteFinancing(financingId) {
                if (confirm('Are you sure you want to delete this financing option?')) {
                    financingOptions = financingOptions.filter(f => f.id !== financingId);
                    saveData();
                    renderFinancingList();
                    alert('Financing option deleted successfully!');
                }
            }

            // Add or update financing
            financingForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const financingData = {
                    id: document.getElementById('editing-financing-id').value || Date.now(),
                    title: document.getElementById('financing-title').value,
                    description: document.getElementById('financing-description').value
                };
                
                if (document.getElementById('editing-financing-id').value) {
                    // Update existing financing
                    const index = financingOptions.findIndex(f => f.id === parseInt(document.getElementById('editing-financing-id').value));
                    if (index !== -1) {
                        financingOptions[index] = financingData;
                    }
                } else {
                    // Add new financing
                    financingOptions.push(financingData);
                }
                
                saveData();
                renderFinancingList();
                resetFinancingForm();
                financingFormContainer.style.display = 'none';
                financingListContainer.style.display = 'block';
                alert(`Financing option ${document.getElementById('editing-financing-id').value ? 'updated' : 'added'} successfully!`);
            });

            // Add logout functionality
            document.getElementById('logout-admin').addEventListener('click', function(e) {
                e.preventDefault();
                if (confirm('Are you sure you want to log out?')) {
                    window.location.href = 'admin.html'; // Reloads to login screen
                }
            });

            // Initialize
            updateDashboardStats();
            renderAdminCarsList();
            renderServicesList();
            renderFinancingList();
        }

        // Auto-logout after 30 minutes of inactivity
        let inactivityTimer;
        function resetInactivityTimer() {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(() => {
                if (adminDashboard.style.display === 'block') {
                    alert('Session expired due to inactivity');
                    window.location.href = 'admin.html';
                }
            }, 30 * 60 * 1000); // 30 minutes
        }

        // Reset timer on user activity
        document.addEventListener('mousemove', resetInactivityTimer);
        document.addEventListener('keypress', resetInactivityTimer);
        resetInactivityTimer();
    </script>
</body>
</html>